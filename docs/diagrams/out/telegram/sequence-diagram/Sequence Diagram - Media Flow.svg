<?plantuml 1.2026.0?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1447px" preserveAspectRatio="none" style="width:2221px;height:1447px;background:#FFFFFF;" version="1.1" viewBox="0 0 2221 1447" width="2221px" zoomAndPan="magnify"><title>Telegram Media Message Flow (Upload &amp; Propagate)</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="659.0547" x="785.1409" y="35.4209">Telegram Media Message Flow (Upload &amp; Propagate)</text><rect fill="#FFFFFF" height="1389.1719" style="stroke:#000000;stroke-width:1;" width="297.1304" x="21" y="52.6094"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="79.2061" x="129.9622" y="64.6763">Client Side</text><rect fill="#F5F5F5" height="1389.1719" style="stroke:#000000;stroke-width:1;" width="165.7441" x="543.3447" y="52.6094"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127.645" x="562.3943" y="64.6763">Connection Layer</text><rect fill="#E6F3FF" height="1389.1719" style="stroke:#000000;stroke-width:1;" width="568.4678" x="721.0889" y="52.6094"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.0073" x="955.3191" y="64.6763">Core Services</text><rect fill="#FFFFE0" height="1389.1719" style="stroke:#000000;stroke-width:1;" width="468.5332" x="1447.7397" y="52.6094"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.2261" x="1611.8933" y="64.6763">Data &amp; Middleware</text><rect fill="#FFE4E1" height="1389.1719" style="stroke:#000000;stroke-width:1;" width="281.0635" x="1928.2729" y="52.6094"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.7617" x="1996.9238" y="64.6763">External Ecosystem</text><g><title>MTProto Gateway</title><rect fill="#FFFFFF" height="174.7969" style="stroke:#000000;stroke-width:1;" width="10" x="621.2168" y="283.7031"/></g><g><title>MTProto Gateway</title><rect fill="#FFFFFF" height="203.9297" style="stroke:#000000;stroke-width:1;" width="10" x="621.2168" y="553.8984"/></g><g><title>Media Service</title><rect fill="#FFFFFF" height="116.5313" style="stroke:#000000;stroke-width:1;" width="10" x="919.2124" y="312.8359"/></g><g><title>Message Service</title><rect fill="#FFFFFF" height="87.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1071.1074" y="641.2969"/></g><g><title>Push Service</title><rect fill="#FFFFFF" height="116.5313" style="stroke:#000000;stroke-width:1;" width="10" x="1218.7197" y="1016.0234"/></g><rect fill="#F9F9F9" height="335.5938" style="stroke:#000000;stroke-width:1;" width="1907.2729" x="15" y="166.0391"/><rect fill="#F0FFF0" height="279.3281" style="stroke:#000000;stroke-width:1;" width="1781.2554" x="15" y="515.6328"/><rect fill="#FFF0F0" height="154.7969" style="stroke:#000000;stroke-width:1;" width="1403.4873" x="192.4058" y="808.9609"/><rect fill="#FFFFE0" height="366.7266" style="stroke:#000000;stroke-width:1;" width="1677.9917" x="537.3447" y="977.7578"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="Alice" id="part1-lifeline"><g><title>User Alice</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="59.0137" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="63" x2="63" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="App" id="part2-lifeline"><g><title>Mobile App</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="254.2681" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="257.4058" x2="257.4058" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="Gateway" id="part3-lifeline"><g><title>MTProto Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="622.2168" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="625.3447" x2="625.3447" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="AuthSvc" id="part4-lifeline"><g><title>Auth Service</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="782.5908" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="786.0889" x2="786.0889" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="MediaSvc" id="part5-lifeline"><g><title>Media Service</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="920.2124" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="924.0928" x2="924.0928" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="MsgSvc" id="part6-lifeline"><g><title>Message Service</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1072.1074" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1075.332" x2="1075.332" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part7" data-qualified-name="PushSvc" id="part7-lifeline"><g><title>Push Service</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1219.7197" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1222.8828" x2="1222.8828" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part8" data-qualified-name="Kafka" id="part8-lifeline"><g><title>Kafka Event Bus</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1514.8164" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1518.7397" x2="1518.7397" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part9" data-qualified-name="Cache" id="part9-lifeline"><g><title>State Cache</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1637.416" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1640.8931" x2="1640.8931" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part10" data-qualified-name="DB" id="part10-lifeline"><g><title>Sharded DB</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1737.5972" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1740.939" x2="1740.939" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part11" data-qualified-name="DFS" id="part11-lifeline"><g><title>Distributed DFS</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1850.2642" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1854.2554" x2="1854.2554" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part12" data-qualified-name="APNS" id="part12-lifeline"><g><title>Push Provider</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="1993.3364" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1997.2729" x2="1997.2729" y1="149.0391" y2="1361.4844"/></g></g><g class="participant-lifeline" data-entity-uid="part13" data-qualified-name="Bob" id="part13-lifeline"><g><title>User Bob</title><rect fill="#000000" fill-opacity="0.00000" height="1212.4453" width="8" x="2166.6279" y="149.0391"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="2169.9194" x2="2169.9194" y1="149.0391" y2="1361.4844"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="Alice" id="part1-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.0273" x="25" y="145.7373">User Alice</text><ellipse cx="63.0137" cy="80.7422" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M63.0137,88.7422 L63.0137,115.7422 M50.0137,96.7422 L76.0137,96.7422 M63.0137,115.7422 L50.0137,130.7422 M63.0137,115.7422 L76.0137,130.7422" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="Alice" id="part1-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.0273" x="25" y="1373.4795">User Alice</text><ellipse cx="63.0137" cy="1385.7813" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M63.0137,1393.7813 L63.0137,1420.7813 M50.0137,1401.7813 L76.0137,1401.7813 M63.0137,1420.7813 L50.0137,1435.7813 M63.0137,1420.7813 L76.0137,1435.7813" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="App" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="91.7246" x="212.4058" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="77.7246" x="219.4058" y="137.7373">Mobile App</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="App" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="91.7246" x="212.4058" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="77.7246" x="219.4058" y="1380.4795">Mobile App</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="Gateway" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="137.7441" x="557.3447" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="123.7441" x="564.3447" y="137.7373">MTProto Gateway</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="Gateway" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="137.7441" x="557.3447" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="123.7441" x="564.3447" y="1380.4795">MTProto Gateway</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="AuthSvc" id="part4-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.0039" x="735.0889" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.0039" x="742.0889" y="137.7373">Auth Service</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="AuthSvc" id="part4-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.0039" x="735.0889" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.0039" x="742.0889" y="1380.4795">Auth Service</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="MediaSvc" id="part5-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.2393" x="868.0928" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.2393" x="875.0928" y="137.7373">Media Service</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="MediaSvc" id="part5-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.2393" x="868.0928" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.2393" x="875.0928" y="1380.4795">Media Service</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="MsgSvc" id="part6-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.5508" x="1010.332" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.5508" x="1017.332" y="137.7373">Message Service</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="MsgSvc" id="part6-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.5508" x="1010.332" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.5508" x="1017.332" y="1380.4795">Message Service</text></g><g class="participant participant-head" data-entity-uid="part7" data-qualified-name="PushSvc" id="part7-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.6738" x="1171.8828" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.6738" x="1178.8828" y="137.7373">Push Service</text></g><g class="participant participant-tail" data-entity-uid="part7" data-qualified-name="PushSvc" id="part7-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.6738" x="1171.8828" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.6738" x="1178.8828" y="1380.4795">Push Service</text></g><g class="participant participant-head" data-entity-uid="part8" data-qualified-name="Kafka" id="part8-head"><path d="M1456.7397,122.7422 L1580.8931,122.7422 C1585.8931,122.7422 1585.8931,135.8906 1585.8931,135.8906 C1585.8931,135.8906 1585.8931,149.0391 1580.8931,149.0391 L1456.7397,149.0391 C1451.7397,149.0391 1451.7397,135.8906 1451.7397,135.8906 C1451.7397,135.8906 1451.7397,122.7422 1456.7397,122.7422" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1580.8931,122.7422 C1575.8931,122.7422 1575.8931,135.8906 1575.8931,135.8906 C1575.8931,149.0391 1580.8931,149.0391 1580.8931,149.0391" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="114.1533" x="1456.7397" y="140.7373">Kafka Event Bus</text></g><g class="participant participant-tail" data-entity-uid="part8" data-qualified-name="Kafka" id="part8-tail"><path d="M1456.7397,1360.4844 L1580.8931,1360.4844 C1585.8931,1360.4844 1585.8931,1373.6328 1585.8931,1373.6328 C1585.8931,1373.6328 1585.8931,1386.7813 1580.8931,1386.7813 L1456.7397,1386.7813 C1451.7397,1386.7813 1451.7397,1373.6328 1451.7397,1373.6328 C1451.7397,1373.6328 1451.7397,1360.4844 1456.7397,1360.4844" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1580.8931,1360.4844 C1575.8931,1360.4844 1575.8931,1373.6328 1575.8931,1373.6328 C1575.8931,1386.7813 1580.8931,1386.7813 1580.8931,1386.7813" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="114.1533" x="1456.7397" y="1378.4795">Kafka Event Bus</text></g><g class="participant participant-head" data-entity-uid="part9" data-qualified-name="Cache" id="part9-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.0459" x="1595.8931" y="145.7373">State Cache</text><path d="M1623.416,96.7422 C1623.416,86.7422 1641.416,86.7422 1641.416,86.7422 C1641.416,86.7422 1659.416,86.7422 1659.416,96.7422 L1659.416,122.7422 C1659.416,132.7422 1641.416,132.7422 1641.416,132.7422 C1641.416,132.7422 1623.416,132.7422 1623.416,122.7422 L1623.416,96.7422" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1623.416,96.7422 C1623.416,106.7422 1641.416,106.7422 1641.416,106.7422 C1641.416,106.7422 1659.416,106.7422 1659.416,96.7422" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part9" data-qualified-name="Cache" id="part9-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.0459" x="1595.8931" y="1373.4795">State Cache</text><path d="M1623.416,1386.7813 C1623.416,1376.7813 1641.416,1376.7813 1641.416,1376.7813 C1641.416,1376.7813 1659.416,1376.7813 1659.416,1386.7813 L1659.416,1412.7813 C1659.416,1422.7813 1641.416,1422.7813 1641.416,1422.7813 C1641.416,1422.7813 1623.416,1422.7813 1623.416,1412.7813 L1623.416,1386.7813" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1623.416,1386.7813 C1623.416,1396.7813 1641.416,1396.7813 1641.416,1396.7813 C1641.416,1396.7813 1659.416,1396.7813 1659.416,1386.7813" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part10" data-qualified-name="DB" id="part10-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="83.3164" x="1696.939" y="145.7373">Sharded DB</text><path d="M1723.5972,96.7422 C1723.5972,86.7422 1741.5972,86.7422 1741.5972,86.7422 C1741.5972,86.7422 1759.5972,86.7422 1759.5972,96.7422 L1759.5972,122.7422 C1759.5972,132.7422 1741.5972,132.7422 1741.5972,132.7422 C1741.5972,132.7422 1723.5972,132.7422 1723.5972,122.7422 L1723.5972,96.7422" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1723.5972,96.7422 C1723.5972,106.7422 1741.5972,106.7422 1741.5972,106.7422 C1741.5972,106.7422 1759.5972,106.7422 1759.5972,96.7422" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part10" data-qualified-name="DB" id="part10-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="83.3164" x="1696.939" y="1373.4795">Sharded DB</text><path d="M1723.5972,1386.7813 C1723.5972,1376.7813 1741.5972,1376.7813 1741.5972,1376.7813 C1741.5972,1376.7813 1759.5972,1376.7813 1759.5972,1386.7813 L1759.5972,1412.7813 C1759.5972,1422.7813 1741.5972,1422.7813 1741.5972,1422.7813 C1741.5972,1422.7813 1723.5972,1422.7813 1723.5972,1412.7813 L1723.5972,1386.7813" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1723.5972,1386.7813 C1723.5972,1396.7813 1741.5972,1396.7813 1741.5972,1396.7813 C1741.5972,1396.7813 1759.5972,1396.7813 1759.5972,1386.7813" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part11" data-qualified-name="DFS" id="part11-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="1796.2554" y="145.7373">Distributed DFS</text><path d="M1836.2642,96.7422 C1836.2642,86.7422 1854.2642,86.7422 1854.2642,86.7422 C1854.2642,86.7422 1872.2642,86.7422 1872.2642,96.7422 L1872.2642,122.7422 C1872.2642,132.7422 1854.2642,132.7422 1854.2642,132.7422 C1854.2642,132.7422 1836.2642,132.7422 1836.2642,122.7422 L1836.2642,96.7422" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1836.2642,96.7422 C1836.2642,106.7422 1854.2642,106.7422 1854.2642,106.7422 C1854.2642,106.7422 1872.2642,106.7422 1872.2642,96.7422" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part11" data-qualified-name="DFS" id="part11-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="1796.2554" y="1373.4795">Distributed DFS</text><path d="M1836.2642,1386.7813 C1836.2642,1376.7813 1854.2642,1376.7813 1854.2642,1376.7813 C1854.2642,1376.7813 1872.2642,1376.7813 1872.2642,1386.7813 L1872.2642,1412.7813 C1872.2642,1422.7813 1854.2642,1422.7813 1854.2642,1422.7813 C1854.2642,1422.7813 1836.2642,1422.7813 1836.2642,1412.7813 L1836.2642,1386.7813" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1836.2642,1386.7813 C1836.2642,1396.7813 1854.2642,1396.7813 1854.2642,1396.7813 C1854.2642,1396.7813 1872.2642,1396.7813 1872.2642,1386.7813" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part12" data-qualified-name="APNS" id="part12-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="110.127" x="1942.2729" y="117.7422"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96.127" x="1949.2729" y="137.7373">Push Provider</text></g><g class="participant participant-tail" data-entity-uid="part12" data-qualified-name="APNS" id="part12-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="110.127" x="1942.2729" y="1360.4844"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96.127" x="1949.2729" y="1380.4795">Push Provider</text></g><g class="participant participant-head" data-entity-uid="part13" data-qualified-name="Bob" id="part13-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63.417" x="2135.9194" y="145.7373">User Bob</text><ellipse cx="2170.6279" cy="80.7422" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M2170.6279,88.7422 L2170.6279,115.7422 M2157.6279,96.7422 L2183.6279,96.7422 M2170.6279,115.7422 L2157.6279,130.7422 M2170.6279,115.7422 L2183.6279,130.7422" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part13" data-qualified-name="Bob" id="part13-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63.417" x="2135.9194" y="1373.4795">User Bob</text><ellipse cx="2170.6279" cy="1385.7813" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M2170.6279,1393.7813 L2170.6279,1420.7813 M2157.6279,1401.7813 L2183.6279,1401.7813 M2170.6279,1420.7813 L2157.6279,1435.7813 M2170.6279,1420.7813 L2183.6279,1435.7813" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g><title>MTProto Gateway</title><rect fill="#FFFFFF" height="174.7969" style="stroke:#000000;stroke-width:1;" width="10" x="621.2168" y="283.7031"/></g><g><title>MTProto Gateway</title><rect fill="#FFFFFF" height="203.9297" style="stroke:#000000;stroke-width:1;" width="10" x="621.2168" y="553.8984"/></g><g><title>Media Service</title><rect fill="#FFFFFF" height="116.5313" style="stroke:#000000;stroke-width:1;" width="10" x="919.2124" y="312.8359"/></g><g><title>Message Service</title><rect fill="#FFFFFF" height="87.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1071.1074" y="641.2969"/></g><g><title>Push Service</title><rect fill="#FFFFFF" height="116.5313" style="stroke:#000000;stroke-width:1;" width="10" x="1218.7197" y="1016.0234"/></g><path d="M15,166.0391 L312.6177,166.0391 L312.6177,173.1719 L302.6177,183.1719 L15,183.1719 L15,166.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="335.5938" style="stroke:#000000;stroke-width:1;" width="1907.2729" x="15" y="166.0391"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252.6177" x="30" y="179.106">1. Media Upload (Encrypted Parts)</text><path d="M263,188.1719 L263,228.1719 L516,228.1719 L516,198.1719 L506,188.1719 L263,188.1719" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M506,188.1719 L506,198.1719 L516,198.1719 L506,188.1719" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="232.2798" x="269" y="205.2388">Media is uploaded via 'saveFilePart'</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="181.0352" x="269" y="220.3716">before the message is sent.</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="246.2681,250.5703,256.2681,254.5703,246.2681,258.5703,250.2681,254.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="63.0137" x2="252.2681" y1="254.5703" y2="254.5703"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="70.0137" y="249.5044">1</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.4629" x="83.0591" y="249.5044">Select Photo &amp; Send</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#000000" points="609.2168,279.7031,619.2168,283.7031,609.2168,287.7031,613.2168,283.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="258.2681" x2="615.2168" y1="283.7031" y2="283.7031"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="265.2681" y="278.6372">2</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="225.748" x="278.3135" y="278.6372">RPC: saveFilePart (bytes, file_id_A)</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg3"><polygon fill="#000000" points="907.2124,308.8359,917.2124,312.8359,907.2124,316.8359,911.2124,312.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="631.2168" x2="913.2124" y1="312.8359" y2="312.8359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="638.2168" y="307.77">3</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.3257" x="651.2622" y="307.77">Stream File Data</text></g><g class="message" data-entity-1="part5" data-entity-2="part11" id="msg4"><polygon fill="#000000" points="1842.2642,337.9688,1852.2642,341.9688,1842.2642,345.9688,1846.2642,341.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="929.2124" x2="1848.2642" y1="341.9688" y2="341.9688"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="936.2124" y="336.9028">4</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="107.1929" x="949.2578" y="336.9028">Write File Chunk</text></g><g class="message" data-entity-1="part11" data-entity-2="part5" id="msg5"><line style="stroke:#000000;stroke-width:1;" x1="930.2124" x2="940.2124" y1="371.1016" y2="367.1016"/><line style="stroke:#000000;stroke-width:1;" x1="930.2124" x2="940.2124" y1="371.1016" y2="375.1016"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="929.2124" x2="1853.2642" y1="371.1016" y2="371.1016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="946.2124" y="366.0356">5</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.5557" x="959.2578" y="366.0356">Checksum OK</text></g><g class="message" data-entity-1="part5" data-entity-2="part10" id="msg6"><polygon fill="#000000" points="1729.5972,396.2344,1739.5972,400.2344,1729.5972,404.2344,1733.5972,400.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="929.2124" x2="1735.5972" y1="400.2344" y2="400.2344"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="936.2124" y="395.1685">6</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="220.9302" x="949.2578" y="395.1685">Save File Metadata (Owner: Alice)</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg7"><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="429.3672" y2="425.3672"/><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="429.3672" y2="433.3672"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="631.2168" x2="923.2124" y1="429.3672" y2="429.3672"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="648.2168" y="424.3013">7</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70.5415" x="661.2622" y="424.3013">Part Saved</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg8"><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="458.5" y2="454.5"/><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="458.5" y2="462.5"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="258.2681" x2="625.2168" y1="458.5" y2="458.5"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="275.2681" y="453.4341">8</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.3125" x="288.3135" y="453.4341">ACK (Part Saved)</text></g><path d="M263,471.5 L263,496.5 L534,496.5 L534,481.5 L524,471.5 L263,471.5" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M524,471.5 L524,481.5 L534,481.5 L524,471.5" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="250.9927" x="269" y="488.5669">App repeats until file is fully uploaded.</text><path d="M15,515.6328 L292.3877,515.6328 L292.3877,522.7656 L282.3877,532.7656 L15,532.7656 L15,515.6328" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="279.3281" style="stroke:#000000;stroke-width:1;" width="1781.2554" x="15" y="515.6328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232.3877" x="30" y="528.6997">2. Send Message (with File Ref)</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg9"><polygon fill="#000000" points="609.2168,549.8984,619.2168,553.8984,609.2168,557.8984,613.2168,553.8984" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="258.2681" x2="615.2168" y1="553.8984" y2="553.8984"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="265.2681" y="548.8325">9</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="330.9033" x="278.3135" y="548.8325">RPC: sendMessage(peer=Bob, input_file=file_id_A)</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg10"><polygon fill="#000000" points="774.5908,579.0313,784.5908,583.0313,774.5908,587.0313,778.5908,583.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="631.2168" x2="780.5908" y1="583.0313" y2="583.0313"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="638.2168" y="577.9653">10</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="107.1294" x="660.3076" y="577.9653">Validate Session</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg11"><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="612.1641" y2="608.1641"/><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="612.1641" y2="616.1641"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="631.2168" x2="785.5908" y1="612.1641" y2="612.1641"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="648.2168" y="607.0981">11</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="670.3076" y="607.0981">OK</text></g><g class="message" data-entity-1="part3" data-entity-2="part6" id="msg12"><polygon fill="#000000" points="1059.1074,637.2969,1069.1074,641.2969,1059.1074,645.2969,1063.1074,641.2969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="631.2168" x2="1065.1074" y1="641.2969" y2="641.2969"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="638.2168" y="636.231">12</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.4604" x="660.3076" y="636.231">Process Message Request</text></g><g class="message" data-entity-1="part6" data-entity-2="part10" id="msg13"><polygon fill="#000000" points="1729.5972,666.4297,1739.5972,670.4297,1729.5972,674.4297,1733.5972,670.4297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1081.1074" x2="1735.5972" y1="670.4297" y2="670.4297"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1088.1074" y="665.3638">13</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="206.6416" x="1110.1982" y="665.3638">Persist Message (Inbox/Outbox)</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg14"><polygon fill="#000000" points="1629.416,695.5625,1639.416,699.5625,1629.416,703.5625,1633.416,699.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1081.1074" x2="1635.416" y1="699.5625" y2="699.5625"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1088.1074" y="694.4966">14</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.2158" x="1110.1982" y="694.4966">Increment Sequence (pts)</text></g><g class="message" data-entity-1="part6" data-entity-2="part3" id="msg15"><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="728.6953" y2="724.6953"/><line style="stroke:#000000;stroke-width:1;" x1="632.2168" x2="642.2168" y1="728.6953" y2="732.6953"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="631.2168" x2="1075.1074" y1="728.6953" y2="728.6953"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="648.2168" y="723.6294">15</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="212.0117" x="670.3076" y="723.6294">Message Accepted (ID assigned)</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg16"><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="757.8281" y2="753.8281"/><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="757.8281" y2="761.8281"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="258.2681" x2="625.2168" y1="757.8281" y2="757.8281"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="275.2681" y="752.7622">16</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136.9634" x="297.3589" y="752.7622">RPC Response (Sent)</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg17"><line style="stroke:#000000;stroke-width:1;" x1="64.0137" x2="74.0137" y1="786.9609" y2="782.9609"/><line style="stroke:#000000;stroke-width:1;" x1="64.0137" x2="74.0137" y1="786.9609" y2="790.9609"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="63.0137" x2="257.2681" y1="786.9609" y2="786.9609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="80.0137" y="781.895">17</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="149.1636" x="102.1045" y="781.895">UI Update (Single Tick)</text></g><path d="M192.4058,808.9609 L465.0771,808.9609 L465.0771,816.0938 L455.0771,826.0938 L192.4058,826.0938 L192.4058,808.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="154.7969" style="stroke:#000000;stroke-width:1;" width="1403.4873" x="192.4058" y="808.9609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="227.6714" x="207.4058" y="822.0278">3. Event Propagation (Fan-out)</text><path d="M849,831.0938 L849,871.0938 L1071,871.0938 L1071,841.0938 L1061,831.0938 L849,831.0938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1061,831.0938 L1061,841.0938 L1071,841.0938 L1061,831.0938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.0811" x="855" y="848.1606">Asynchronous processing after</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="79.3647" x="855" y="863.2935">persistence.</text><g class="message" data-entity-1="part6" data-entity-2="part8" id="msg18"><polygon fill="#000000" points="1506.8164,893.4922,1516.8164,897.4922,1506.8164,901.4922,1510.8164,897.4922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1076.1074" x2="1512.8164" y1="897.4922" y2="897.4922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1083.1074" y="892.4263">18</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="234.6284" x="1105.1982" y="892.4263">Publish Event (NewMessageUpdate)</text></g><g class="message" data-entity-1="part8" data-entity-2="part3" id="msg19"><line style="stroke:#000000;stroke-width:1;" x1="627.2168" x2="637.2168" y1="926.625" y2="922.625"/><line style="stroke:#000000;stroke-width:1;" x1="627.2168" x2="637.2168" y1="926.625" y2="930.625"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="626.2168" x2="1517.8164" y1="926.625" y2="926.625"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="643.2168" y="921.5591">19</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="225.1641" x="665.3076" y="921.5591">Consume (Sync to Online Devices)</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg20"><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="955.7578" y2="951.7578"/><line style="stroke:#000000;stroke-width:1;" x1="259.2681" x2="269.2681" y1="955.7578" y2="959.7578"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="258.2681" x2="625.2168" y1="955.7578" y2="955.7578"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="275.2681" y="950.6919">20</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.2778" x="297.3589" y="950.6919">Update UI (Double Tick if read)</text></g><path d="M537.3447,977.7578 L766.0776,977.7578 L766.0776,984.8906 L756.0776,994.8906 L537.3447,994.8906 L537.3447,977.7578" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="366.7266" style="stroke:#000000;stroke-width:1;" width="1677.9917" x="537.3447" y="977.7578"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183.7329" x="552.3447" y="990.8247">4. Delivery to Bob (Push)</text><g class="message" data-entity-1="part8" data-entity-2="part7" id="msg21"><line style="stroke:#000000;stroke-width:1;" x1="1229.7197" x2="1239.7197" y1="1016.0234" y2="1012.0234"/><line style="stroke:#000000;stroke-width:1;" x1="1229.7197" x2="1239.7197" y1="1016.0234" y2="1020.0234"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1228.7197" x2="1517.8164" y1="1016.0234" y2="1016.0234"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1245.7197" y="1010.9575">21</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="249.0059" x="1267.8105" y="1010.9575">Consume Event (NewMessageUpdate)</text></g><g class="message" data-entity-1="part7" data-entity-2="part9" id="msg22"><polygon fill="#000000" points="1629.416,1041.1563,1639.416,1045.1563,1629.416,1049.1563,1633.416,1045.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1228.7197" x2="1635.416" y1="1045.1563" y2="1045.1563"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1235.7197" y="1040.0903">22</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.5454" x="1257.8105" y="1040.0903">Lookup Bob's Session/Token</text></g><g class="message" data-entity-1="part7" data-entity-2="part10" id="msg23"><polygon fill="#000000" points="1729.5972,1070.2891,1739.5972,1074.2891,1729.5972,1078.2891,1733.5972,1074.2891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1228.7197" x2="1735.5972" y1="1074.2891" y2="1074.2891"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1235.7197" y="1069.2231">23</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="238.145" x="1257.8105" y="1069.2231">Check Notification Settings (Muted?)</text></g><g class="message" data-entity-1="part10" data-entity-2="part7" id="msg24"><line style="stroke:#000000;stroke-width:1;" x1="1229.7197" x2="1239.7197" y1="1103.4219" y2="1099.4219"/><line style="stroke:#000000;stroke-width:1;" x1="1229.7197" x2="1239.7197" y1="1103.4219" y2="1107.4219"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1228.7197" x2="1740.5972" y1="1103.4219" y2="1103.4219"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1245.7197" y="1098.356">24</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="67.7104" x="1267.8105" y="1098.356">Not Muted</text></g><g class="message" data-entity-1="part7" data-entity-2="part12" id="msg25"><polygon fill="#000000" points="1985.3364,1128.5547,1995.3364,1132.5547,1985.3364,1136.5547,1989.3364,1132.5547" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1223.7197" x2="1991.3364" y1="1132.5547" y2="1132.5547"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1230.7197" y="1127.4888">25</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="254.9282" x="1252.8105" y="1127.4888">Send Notification ("Alice sent a photo")</text></g><g class="message" data-entity-1="part12" data-entity-2="part13" id="msg26"><line style="stroke:#000000;stroke-width:1;" x1="2168.6279" x2="2158.6279" y1="1161.6875" y2="1157.6875"/><line style="stroke:#000000;stroke-width:1;" x1="2168.6279" x2="2158.6279" y1="1161.6875" y2="1165.6875"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1997.3364" x2="2169.6279" y1="1161.6875" y2="1161.6875"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="2004.3364" y="1156.6216">26</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.2007" x="2026.4272" y="1156.6216">System Notification</text></g><g class="message" data-entity-1="part13" data-entity-2="part3" id="msg27"><polygon fill="#000000" points="637.2168,1186.8203,627.2168,1190.8203,637.2168,1194.8203,633.2168,1190.8203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="631.2168" x2="2169.6279" y1="1190.8203" y2="1190.8203"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="643.2168" y="1185.7544">27</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="189.3633" x="665.3076" y="1185.7544">Open App / updates.getState</text></g><g class="message" data-entity-1="part3" data-entity-2="part6" id="msg28"><polygon fill="#000000" points="1064.1074,1215.9531,1074.1074,1219.9531,1064.1074,1223.9531,1068.1074,1219.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="626.2168" x2="1070.1074" y1="1219.9531" y2="1219.9531"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="633.2168" y="1214.8872">28</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.8672" x="655.3076" y="1214.8872">Fetch Diff</text></g><g class="message" data-entity-1="part6" data-entity-2="part11" id="msg29"><polygon fill="#000000" points="1842.2642,1245.0859,1852.2642,1249.0859,1842.2642,1253.0859,1846.2642,1249.0859" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1076.1074" x2="1848.2642" y1="1249.0859" y2="1249.0859"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1083.1074" y="1244.02">29</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.8857" x="1105.1982" y="1244.02">Retrieve Photo Thumbnail</text></g><g class="message" data-entity-1="part11" data-entity-2="part6" id="msg30"><line style="stroke:#000000;stroke-width:1;" x1="1077.1074" x2="1087.1074" y1="1278.2188" y2="1274.2188"/><line style="stroke:#000000;stroke-width:1;" x1="1077.1074" x2="1087.1074" y1="1278.2188" y2="1282.2188"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1076.1074" x2="1853.2642" y1="1278.2188" y2="1278.2188"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1093.1074" y="1273.1528">30</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="36.48" x="1115.1982" y="1273.1528">Bytes</text></g><g class="message" data-entity-1="part6" data-entity-2="part3" id="msg31"><line style="stroke:#000000;stroke-width:1;" x1="627.2168" x2="637.2168" y1="1307.3516" y2="1303.3516"/><line style="stroke:#000000;stroke-width:1;" x1="627.2168" x2="637.2168" y1="1307.3516" y2="1311.3516"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="626.2168" x2="1075.1074" y1="1307.3516" y2="1307.3516"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="643.2168" y="1302.2856">31</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="93.5518" x="665.3076" y="1302.2856">Update Object</text></g><g class="message" data-entity-1="part3" data-entity-2="part13" id="msg32"><line style="stroke:#000000;stroke-width:1;" x1="2168.6279" x2="2158.6279" y1="1336.4844" y2="1332.4844"/><line style="stroke:#000000;stroke-width:1;" x1="2168.6279" x2="2158.6279" y1="1336.4844" y2="1340.4844"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="626.2168" x2="2169.6279" y1="1336.4844" y2="1336.4844"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="633.2168" y="1331.4185">32</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.1338" x="655.3076" y="1331.4185">Display Photo</text></g><?plantuml-src XLVRRjiu47ttLynwWKO66lUA1TP0kuZZU16aQOmusRuKA6XfP7CZargISkg_tqDISYpPIHF05seubpDdBlxDhNZDL1P2gfwed5RLUi6crtFI5KntNF3IY3LTSoO5NgqLIwPfeHyfkIyBBJ9wHJEZIx4KZWUztWcTdfxIJ1WdKraAvInDE9TAEgcLVzRhBVHFwfyNafMZkSouJxz_Mqd7FIAHEcseVs_Pq5aXKpmJDdx2q_99A_MlzKB2mxEoZ39bsMEL4PGt5hHId0QpNyIMJMDcljOFXzhk48JJz3UYU1JReBB-VA3MCCtPRE2JXSwBFwOVfjEklhFAhHgfw1yEvflqm6x0TLymd1oLZDYtPEtoYEIiictR_i3BjGEP22UGl6kPPGNYD3uFK_nTl8N2_ogkcFfN8dyGTB7ngHfNDcWBPn39S7yXBAJc3aZHkKXNqLxur9PO2PDnHfDn49YCMqydqZeZ5vNp4jDv59dEE_vU_7Hib2Ze8jLsQnsluV0rhcvljUMZ822d6n3Cn0pCliux51lhHNY4zoTZaS61ukz6DV5hgYSpmwTv8PShDuXSNXfTbS3jJ_zFxuOT-GkLcctfu_8LOGUmJwGqq39U2UdS4xUn8YrLuIBaD_X-OiM6fs2vltpoNIquz-H3oTAwPWEkM2Hds0kQGw7GwUUeT8xYJHtDLfxOh_1LPL6gBBrCJUyHtSxEHxHlYfB5rh5zJJaEViZinrbq7D39ZKzrKnd-CBpK1rvjmr_OTuRHEhnMycHhwzZZUQsaEV5QaFuHVJCertZ_V5MfXo259u3-yxwXynMd3xPQqytLCzh6y0O1HbtNx8Gd7oKtZuhDAC8swDpo9dOG1LIyXeXWnY-4iSF2QmY9E3k_0dLsAWPT7GTm7c68JvhXaWKQQgMSB49oVFxpgYYsE-8CFP5R97u_2gdVDUzRHd5Rr-RlMnJ-Mte_R8icZn9jB81so_dW1VRWLdqfAPdD9rJKQvAghDmFx-UdNp6fowAwNOxe7r78p4lEeHwzFFeGdtQIXEmVa34qo95l1EZMjej1Xv5DDsqO5But_9cniMWsJzXSAhIBDpULmzkWSo5qm15TelmnNlsSymOLYZCfcpRGkj8Af35nbgOScaToEK6RidAfZh2dw_OX_v0YH6nBhT1j4sJO_Pg28Sr1Wo-E4TrVegc5H2HpgPP-Dv3fm-20RHz0LRjLwMufs8tzXceW6gZsOLYFbNsvP2hKgQxSuDd4XCeeE0-5qMGt65mPhNHbgOofXeyaSaoCxwgCcVFm3uzbDmmq9BXQ51938xgLVEN7EWynxb_Y7cTbEvFOGT2NF6OU4hJX6rL8XNR8ONqOF9Em6cbWdamqt8fWaypH0aHs2Fh74JGMSiDcwutSCgPWMAywm6EsqyTXInQ5Yjw4OJde1b5l3Kz1l0ZC3fPcsTZXKX_ibSKNhH_W4KoVsAQktznXArFT2xxmGdUdhzh9NAQH9tDs3Wcsb5pxfU6lwC9at74SToW877N6xmDrQsmfJ_fnZFgvIe9AFpxx1za_2DEhY_OH5_I63QMb-KdMWxxVGszALg7Ytg2FUqpjSCakh5NFTRGfktH54vddtLxb9-SjOw5Y3Bmu_EzMsEgLa4LdWjQwndxQFz-EQZRUBFx5Ed78s10kLZZyXjX6UvwV_mC0?></g></svg>